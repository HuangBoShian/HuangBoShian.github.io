<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" href="style.css">

    <!-- JavaScript 依賴 -->
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

    <script>
        // 解析 URL 參數
        function getUrlParam(paramName) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(paramName);
        }

        // 在頁面加載時執行
        $(document).ready(function () {
            const pid = getUrlParam('pid');
            const title = decodeURIComponent(getUrlParam('title'));
            const info = decodeURIComponent(getUrlParam('info'));

            // 顯示選擇的商品
            const productDetails = `
                <h5>您選擇的商品：</h5>
                <p><strong>${title}</strong></p>
                <p>${info}</p>
            `;
            $('#product-info').html(productDetails);

            // 將商品名稱寫入表單隱藏欄位
            $('#product-title').val(title);
        });

        // 表單提交邏輯
        function formresponse() {
            const address = document.forms["form1"]["address"].value;
            const phone = document.forms["form1"]["phone"].value;
            const cardNumber = document.forms["form1"]["number"].value;
            const securityCode = document.forms["form1"]["code"].value;

            if (!address || !phone || !cardNumber || !securityCode) {
                alert("所有欄位都是必填的！");
                return false;
            }

            alert("感謝購買！");
            window.location.href = "thank.html";
        }
    </script>
</head>
<body>
    <!-- Header -->
    <nav>
        <div class="nav-wrapper">
            <a href="index.html" class="brand-logo">&ensp;Chiikawa Market</a>
        </div>
    </nav>

    <div class="container">
        <!-- 商品資訊顯示區域 -->
        <div id="product-info"></div>

        <!-- 購買表單 -->
        <form name="form1" onsubmit="formresponse(); return false;">
            <div class="input-field">
                <input id="address" name="address" type="text" class="validate">
                <label for="address">地址</label>
            </div>
            <div class="input-field">
                <input id="phone" name="phone" type="tel" class="validate">
                <label for="phone">電話</label>
            </div>
            <div class="input-field">
                <input id="number" name="number" type="text" class="validate">
                <label for="number">信用卡卡號</label>
            </div>
            <div class="input-field">
                <input id="code" name="code" type="text" class="validate">
                <label for="code">安全碼</label>
            </div>

            <!-- 隱藏欄位存儲商品名稱 -->
            <input id="product-title" name="product-title" type="hidden">

            <button type="submit" class="waves-effect waves-light btn">提交訂單</button>
        </form>
    </div>

    <!-- Footer -->
    <footer class="page-footer">
        <div class="container">
            <p class="grey-text text-lighten-4">© Chiikawa Market</p>
        </div>
    </footer>
</body>
</html>
