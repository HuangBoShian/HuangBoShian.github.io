<!DOCTYPE html>
<html>
    <head>
        <!-- 利用Google Visualization讀取Google Sheet https://www.labnol.org/code/google-sheet-d3js-visualization-200608 -->
        <script src="https://www.gstatic.com/charts/loader.js"></script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js" integrity="sha512-bPs7Ae6pVvhOSiIcyUClR7/q2OAsRiovw4vAkX+zJbw3ShAeeqezq50RIIcIURq7Oa20rW2n2q+fyXBNcU9lrw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title></title>

        <!--Import Google Icon Font-->
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

        <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>

        <!-- Compiled and minified CSS -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

        <!-- Compiled and minified JavaScript -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

        <!-- Owl Stylesheets -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.css">

        <!-- javascript -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.js"></script>
          
        <script type="text/javascript">

        // 取得網址裡的參數 
        function GetUrlVar(VarName) 
        {
          name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
          var regexS = "[\\?&]" + VarName + "=([^&#]*)";
          var regex = new RegExp(regexS);
          var results = regex.exec(window.location.href);
          if (results == null)
             return "";
          else
             return results[1];
        }

        let text = "";
        let title = [];
        let image = [];
        let info = [];
        google.charts.load('current', {'packages':['corechart']});
        google.charts.setOnLoadCallback(init);

        function init(){
            var url = 'https://docs.google.com/spreadsheets/d/1y0V1PAjGfsJIDwnHHmaFcTO4Ojx2rgiB03jTBDYeIhc/gviz/tq?sheet=工作表1';
            var query = new google.visualization.Query(url);
            query.setQuery('select *'); //where A=
            query.send(processSheetsData);
        }     

        function processSheetsData(response) {
            var data = response.getDataTable();
            var columns = data.getNumberOfColumns();
            var rows = data.getNumberOfRows();

            // var str = "";
            for(var r = 0 ; r < rows ; r++){
                // str += data.getFormattedValue(r,0) + "(" +  data.getFormattedValue(r,1) + ")" + " 訂 " +  data.getFormattedValue(r,2) + " : " + data.getFormattedValue(r,3) + "個 <br />";
                image[r] = data.getFormattedValue(r,0);
                title[r] = data.getFormattedValue(r,1);
                info[r] = data.getFormattedValue(r,2);
            }
            // document.getElementById("demo").innerHTML = str;
        }

        function detail(){
            var Y = decodeURIComponent(GetUrlVar('pid'));
            
            text += '<h4>' + title[Y] + '</h4>';
            text += '<img src="' + image[Y] + '">';
            
            document.getElementById("demo").innerHTML += text;
        }

    </script>   
  </head>
  <body>
    <!-- header -->
    <nav>
        <div class="nav-wrapper">
            <a href="#" class="brand-logo"> Chiikawa Market </a>
            <ul id="nav-mobile" class="right hide-on-med-and-down">
                <li><a href="index.html">首頁</a></li>
                <li><a href="bill.html">購物車</a></li>
                <li><a href="order.html">查詢訂單</a></li>
            </ul>
        </div>
    </nav>
  
  <div class="row" id="demo">
  </div>

  <!-- <script type="text/javascript">detail();</script> -->
                  
  <a href="javascript:detail();">顯示細節</a>

  <!-- footer -->
    <footer class="page-footer">
        <div class="container">
            <div class="row">
                <div class="col l6 s12">
                    <h5 class="white-text">Footer Content</h5>
                    <p class="grey-text text-lighten-4">You can use rows and columns here to organize your footer content.</p>
                </div>
                <div class="col l4 offset-l2 s12">
                    <h5 class="white-text">Links</h5>
                    <ul>
                        <li><a class="grey-text text-lighten-3" href="#!">Link 1</a></li>
                        <li><a class="grey-text text-lighten-3" href="#!">Link 2</a></li>
                        <li><a class="grey-text text-lighten-3" href="#!">Link 3</a></li>
                        <li><a class="grey-text text-lighten-3" href="#!">Link 4</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="footer-copyright">
            <div class="container">
                © 2024 Copyright Text
                <a class="grey-text text-lighten-4 right" href="#!">More Links</a>
            </div>
        </div>
    </footer>
</body>
</html>
